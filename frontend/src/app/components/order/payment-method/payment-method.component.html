<!-- payment-method.component.html -->
<div class="payment-container">
  <h2>Izberite naÄin plaÄila</h2>

  <!-- Order Summary -->
  <div class="order-summary">
    <h3>Povzetek naroÄila</h3>
    <div class="order-items">
      @for (item of cartItems; track item.product.id) {
        <div class="order-item">
          <span class="item-name">{{ item.product.name }}</span>
          <span class="item-quantity">x{{ item.quantity }}</span>
          <span class="item-price">{{ calculateItemPrice(item.product.price, item.quantity) | currency:'EUR' }}</span>
        </div>
      }
    </div>
    
    <div class="order-totals">
      <div class="total-line">
        <span>Cena vseh izdelkov(vkljuÄno z DDV):</span>
        <span>{{ subtotal | currency:'EUR' }}</span>
      </div>
      <div class="total-line">
        <span>Dostava:</span>
        <span>{{ shippingCost === 0 ? 'BrezplaÄno' : (shippingCost | currency:'EUR') }}</span>
      </div>
      @if (subtotal >= 50) {
        <div class="free-shipping-note">
          <small>ğŸ‰ BrezplaÄna dostava za naroÄila nad 50,00 â‚¬</small>
        </div>
      }
      <div class="total-line total-amount">
        <span><strong>Skupaj:</strong></span>
        <span><strong>{{ totalAmount | currency:'EUR' }}</strong></span>
      </div>
    </div>
  </div>

  <div class="payment-options">
    <!-- UPN Payment -->
    <div class="payment-option" [class.selected]="selectedMethod === 'upn'" (click)="selectMethod('upn')">
      <div class="option-header">
        <i class="icon cash"></i>
        <h3>UPN PlaÄilo</h3>
      </div>
      <p>PlaÄilo preko UPN naloga, ki ga dobite na mail</p>
    </div>

    <!-- Cash on Delivery -->
    <div class="payment-option" [class.selected]="selectedMethod === 'cash'" (click)="selectMethod('cash')">
      <div class="option-header">
        <i class="icon cash"></i>
        <h3>Po prevzetju</h3>
      </div>
      <p>PlaÄilo v gotovini ob prevzemu paketa</p>
    </div>

  <!-- Card Payment Form -->
  @if (selectedMethod === 'upn') {

  <div class="payment-confirmation">
    <div class="confirmation-content">
      <i class="icon cash-large"></i>
      <h3>UPN PlaÄilo</h3>
      <p>Ko plaÄate vam poÅ¡ljemo paket.</p>
      <p>Skupni znesek: <strong>{{ totalAmount | currency:'EUR' }}</strong></p>
      <button class="confirm-button" (click)="confirmPayment()">Potrdi naroÄilo</button>
    </div>
  </div>
  }
  <!-- Cash on Delivery Confirmation -->
  @if (selectedMethod == 'cash') {

  <div class="payment-confirmation">
    <div class="confirmation-content">
      <i class="icon cash-large"></i>
      <h3>PlaÄilo po prevzetju</h3>
      <p>Pri prevzemu paketa boste plaÄali znesek.</p>
      <p>Skupni znesek: <strong>{{ totalAmount | currency:'EUR' }}</strong></p>
      <button class="confirm-button" (click)="confirmPayment()">Potrdi naroÄilo</button>
    </div>
  </div>
  }
</div>